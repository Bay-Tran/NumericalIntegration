/**
 * \file QuadratureKronrod.h
 * \sa R Piessens, E de Doncker-Kapenger, C Ueberhuber, D Kahaner, QUADPACK, A Subroutine Package
 *     for Automatic Integration, Springer Verlag, 1983.
 */

#ifndef EIGEN_QUADRATURE_KRONROD_H
#define EIGEN_QUADRATURE_KRONROD_H

#include <Eigen/Dense>

namespace Eigen
{

/**
 * \brief The abscissae and weights are given for the interval (-1,1).
 *
 * Because of symmetry, only the positive abscissae and their corresponding weights are given.
 *
 * \var abscissaeGaussKronrod15 The abscissae of the 15 point kronrod rule.
 * \var abscissaeGaussKronrod21 The abscissae of the 21 point kronrod rule.
 * \var abscissaeGaussKronrod31 The abscissae of the 31 point kronrod rule.
 * \var abscissaeGaussKronrod41 The abscissae of the 41 point kronrod rule.
 * \var abscissaeGaussKronrod51 The abscissae of the 51 point kronrod rule.
 * \var abscissaeGaussKronrod61 The abscissae of the 61 point kronrod rule.
 *
 * \var weightsGaussKronrod15 The weights of the 15 point kronrod rule.
 * \var weightsGaussKronrod21 The weights of the 21 point kronrod rule.
 * \var weightsGaussKronrod31 The weights of the 31 point kronrod rule.
 * \var weightsGaussKronrod41 The weights of the 41 point kronrod rule.
 * \var weightsGaussKronrod51 The weights of the 51 point kronrod rule.
 * \var weightsGaussKronrod61 The weights of the 61 point kronrod rule.
 *
 * \var weightsGauss15 The weights of the  7 point gauss rule.
 * \var weightsGauss21 The weights of the 10 point gauss rule.
 * \var weightsGauss31 The weights of the 15 point gauss rule.
 * \var weightsGauss41 The weights of the 20 point gauss rule.
 * \var weightsGauss51 The weights of the 25 point gauss rule.
 * \var weightsGauss61 The weights of the 30 point gauss rule.
 */
template <typename Scalar_>
class QuadratureKronrod
{
public:
  static const Array<Scalar_, 8, 1> abscissaeGaussKronrod15;
  static const Array<Scalar_, 8, 1> weightsGaussKronrod15;
  static const Array<Scalar_, 4, 1> weightsGauss15;

  static const Array<Scalar_, 11, 1> abscissaeGaussKronrod21;
  static const Array<Scalar_, 11, 1> weightsGaussKronrod21;
  static const Array<Scalar_, 5, 1> weightsGauss21;

  static const Array<Scalar_, 16, 1> abscissaeGaussKronrod31;
  static const Array<Scalar_, 16, 1> weightsGaussKronrod31;
  static const Array<Scalar_, 8, 1> weightsGauss31;

  static const Array<Scalar_, 21, 1> abscissaeGaussKronrod41;
  static const Array<Scalar_, 21, 1> weightsGaussKronrod41;
  static const Array<Scalar_, 10, 1> weightsGauss41;

  static const Array<Scalar_, 26, 1> abscissaeGaussKronrod51;
  static const Array<Scalar_, 26, 1> weightsGaussKronrod51;
  static const Array<Scalar_, 13, 1> weightsGauss51;

  static const Array<Scalar_, 31, 1> abscissaeGaussKronrod61;
  static const Array<Scalar_, 31, 1> weightsGaussKronrod61;
  static const Array<Scalar_, 15, 1> weightsGauss61;

};

template <typename Scalar_>
const Array<Scalar_, 8, 1> QuadratureKronrod<Scalar_>::abscissaeGaussKronrod15 =
  (Array<Scalar_, 8, 1>() <<
    0.991455371120812639206854697526354,
    0.949107912342758524526189684047851,
    0.864864423359769072789712788640926,
    0.741531185599394439863864773280788,
    0.586087235467691130294144838258730,
    0.405845151377397166906606412076961,
    0.207784955007898467600689403773245,
    0.000000000000000000000000000000000
  ).finished();

template <typename Scalar_>
const Array<Scalar_, 8, 1> QuadratureKronrod<Scalar_>::weightsGaussKronrod15 =
  (Array<Scalar_, 8, 1>() <<
    0.0229353220105291970241739755861367,
    0.063092092629978554212080554604673,
    0.104790010322250182379955957561892,
    0.140653259715525920404714742502249,
    0.169004726639267900480074748790968,
    0.190350578064785412570564415535103,
    0.204432940075298889577082135556133,
    0.209482141084727830906199334739021
  ).finished();

template <typename Scalar_>
const Array<Scalar_, 4, 1> QuadratureKronrod<Scalar_>::weightsGauss15 =
  (Array<Scalar_, 4, 1>() <<
    0.129484966168869693270604300505893,
    0.279705391489276667597697951167315,
    0.381830050505118944950365864707924,
    0.417959183673469387755102040816401
  ).finished();

template <typename Scalar_>
const Array<Scalar_, 11, 1> QuadratureKronrod<Scalar_>::abscissaeGaussKronrod21 =
  (Array<Scalar_, 11, 1>() <<
    0.995657163025808080735527280689007,
    0.973906528517171720077964012084452,
    0.930157491355708226001207180059508,
    0.865063366688984510732096688423493,
    0.780817726586416897063717578345042,
    0.679409568299024406234327365114874,
    0.562757134668604683339000099272694,
    0.433395394129247190799265943165784,
    0.294392862701460198131126603103866,
    0.14887433898163121088482600112972,
    0.000000000000000000000000000000000
  ).finished();

template <typename Scalar_>
const Array<Scalar_, 11, 1> QuadratureKronrod<Scalar_>::weightsGaussKronrod21 =
  (Array<Scalar_, 11, 1>() <<
    0.011694638867371865645889417606109,
    0.032558162307964729372468379093124,
    0.054755896574351992988253161304339,
    0.075039674810919951736998362051291,
    0.093125454583697600365534567602140,
    0.109387158802297647988636942301704,
    0.123491976262065844222776339692895,
    0.134709217311473333397495843887845,
    0.142775938577060072871437554598580,
    0.147739104901338499578563651656728,
    0.149445554002916897369041719294823
  ).finished();

template <typename Scalar_>
const Array<Scalar_, 5, 1> QuadratureKronrod<Scalar_>::weightsGauss21 =
  (Array<Scalar_, 5, 1>() <<
    0.066671344308688137593555036994374,
    0.149451349150580587518047076253702,
    0.219086362515982043995422844816799,
    0.269266719309996355091226920888612,
    0.295524224714752870173892994643328
  ).finished();

template <typename Scalar_>
const Array<Scalar_, 16, 1> QuadratureKronrod<Scalar_>::abscissaeGaussKronrod31 =
  (Array<Scalar_, 16, 1>() <<
    0.998002298693397060285172840152273,
    0.987992518020485428489565718586613,
    0.967739075679139134257347978784337,
    0.937273392400705904307758947710209,
    0.897264532344081900882509656454496,
    0.848206583410427216200648320774217,
    0.790418501442465932967649294817947,
    0.724417731360170047416186054613938,
    0.650996741297416970533735895313275,
    0.570972172608538847537226737253911,
    0.485081863640239680693655740232351,
    0.394151347077563369897207370981045,
    0.299180007153168812166780024266389,
    0.201194093997434522300628303394596,
    0.101142066918717499027074231447392,
    0.000000000000000000000000000000000
  ).finished();

template <typename Scalar_>
const Array<Scalar_, 16, 1> QuadratureKronrod<Scalar_>::weightsGaussKronrod31 =
  (Array<Scalar_, 16, 1>() <<
    0.005377479872923344978543547494514,
    0.015007947329316122975380346156106,
    0.025460847326715319477885508432833,
    0.035346360791375834553865668217379,
    0.044589751324764875370576202976841,
    0.053481524690928088750725126423176,
    0.062009567800670638564027982943994,
    0.069854121318728260644539156133929,
    0.076849680757720376761425651333417,
    0.083080502823133023347239582435977,
    0.088564443056211768189118347588594,
    0.093126598170825323807710248003669,
    0.096642726983623675822805391127784,
    0.099173598721791962087352950606036,
    0.100769845523875592248021595403498,
    0.101330007014791551827577832782446
  ).finished();

template <typename Scalar_>
const Array<Scalar_, 8, 1> QuadratureKronrod<Scalar_>::weightsGauss31 =
  (Array<Scalar_, 8, 1>() <<
    0.030753241996117268354613354053633,
    0.070366047488108111282989049126046,
    0.107159220467171935007116052704801,
    0.139570677926154314447800460262626,
    0.166269205816993933553200859246184,
    0.186161000015562211026800561866340,
    0.198431485327111576456118326443801,
    0.202578241925561272880620199967689
  ).finished();

template <typename Scalar_>
const Array<Scalar_, 21, 1> QuadratureKronrod<Scalar_>::abscissaeGaussKronrod41 =
  (Array<Scalar_, 21, 1>() <<
    0.998859031588277663838315576545864,
    0.99312859918509492478612238847132,
    0.981507877450250259193342994720217,
    0.963971927277913791267666131197277,
    0.940822633831754753519982722212443,
    0.912234428251325905867752441203298,
    0.878276811252281976077442995113078,
    0.839116971822218823394529061701521,
    0.795041428837551198350638833272788,
    0.746331906460150792614305070355642,
    0.693237656334751384805490711845932,
    0.636053680726515025452836696226286,
    0.575140446819710315342946036586425,
    0.510867001950827098004364050955251,
    0.443593175238725103199992213492640,
    0.373706088715419560672548177024927,
    0.301627868114913004320555356858592,
    0.227785851141645078080496195368575,
    0.152605465240922675505220241022678,
    0.076526521133497333754640409398838,
    0.000000000000000000000000000000000
  ).finished();

template <typename Scalar_>
const Array<Scalar_, 21, 1> QuadratureKronrod<Scalar_>::weightsGaussKronrod41 =
  (Array<Scalar_, 21, 1>() <<
    0.003073583718520529670610188483432,
    0.008600269855642941885922310358902,
    0.014626169256971253490004296940125,
    0.020388373461266508609702484103434,
    0.025882133604951159732461495616700,
    0.031287306777032797859809324451455,
    0.036600169758200799300380714781656,
    0.041668873327973684820192848040990,
    0.046434821867497676331263392810620,
    0.050944573923728690163791026102430,
    0.055195105348285996659797272553472,
    0.059111400880639570325109329507510,
    0.062653237554781170199590962818858,
    0.065834597133618419826792527807894,
    0.068648672928521621727352702360567,
    0.071054423553444044323267387966570,
    0.073030690332786670028950477400463,
    0.074582875400499152207980914011679,
    0.075704497684556677284458920410794,
    0.076377867672080733338277493430925,
    0.076600711917999659102670966343970
  ).finished();

template <typename Scalar_>
const Array<Scalar_, 10, 1> QuadratureKronrod<Scalar_>::weightsGauss41 =
  (Array<Scalar_, 10, 1>()  <<
    0.017614007139152118311848701274797,
    0.040601429800386926366755822154429,
    0.062672048334109063559179561995314,
    0.083276741576704748724724053664387,
    0.101930119817240435036749951086899,
    0.118194531961518417312377376939532,
    0.131688638449176626898494499747538,
    0.142096109318382028786969494056355,
    0.149172986472603710968879540270136,
    0.152753387130725849946504948149552
  ).finished();

template <typename Scalar_>
const Array<Scalar_, 26, 1> QuadratureKronrod<Scalar_>::abscissaeGaussKronrod51 =
  (Array<Scalar_, 26, 1>() <<
    0.999262104992609834193457486540341,
    0.995556969790498097908784946893902,
    0.988035794534077247637331014577406,
    0.976663921459517511498315386479594,
    0.961614986425842512418130033660167,
    0.942974571228974339414011169658471,
    0.920747115281701561746346084546331,
    0.894991997878275368851042006782805,
    0.865847065293275595448996969588340,
    0.833442628760834001421021108693570,
    0.797873797998500059410410904994307,
    0.759259263037357630577282865204361,
    0.717766406813084388186654079773298,
    0.673566368473468364485120633247622,
    0.626810099010317412788122681624518,
    0.577662930241222967723689841612654,
    0.526325284334719182599623778158010,
    0.473002731445714960522182115009193,
    0.417885382193037748851814394594572,
    0.361172305809387837735821730127641,
    0.303089538931107830167478909980339,
    0.243866883720988432045190362797452,
    0.183718939421048892015969888759528,
    0.122864692610710396387359818808037,
    0.061544483005685078886546392366797,
    0.000000000000000000000000000000000
  ).finished();

template <typename Scalar_>
const Array<Scalar_, 26, 1> QuadratureKronrod<Scalar_>::weightsGaussKronrod51 =
  (Array<Scalar_, 26, 1>() <<
    0.001987383892330314605893000886890,
    0.005561932135356713838962677124619,
    0.009473973386174151474862238893272,
    0.013236229195571661268514375168336,
    0.016847817709128297997697074347417,
    0.020435371145882835728640349125158,
    0.024009945606953215886887558750600,
    0.027475317587851738183542384141898,
    0.030792300167387488463780012292025,
    0.034002130274329338309095260270804,
    0.037116271483415543045238885503532,
    0.040083825504032382630740082087988,
    0.042872845020170048881915546532145,
    0.045502913049921789541661716954631,
    0.047982537138836713240500786863562,
    0.050277679080715672660798865890210,
    0.052362885806407475137685693911729,
    0.054251129888545413911804007608663,
    0.055950811220412316531767200590781,
    0.057437116361567831635055505754738,
    0.058689680022394207147491249997474,
    0.059720340324174055685419088516435,
    0.060539455376045862105206551808149,
    0.061128509717053048547330231251863,
    0.061471189871425315808460002635750,
    0.061580818067832935933565434686576
  ).finished();

template <typename Scalar_>
const Array<Scalar_, 13, 1> QuadratureKronrod<Scalar_>::weightsGauss51 =
  (Array<Scalar_, 13, 1>() <<
    0.011393798501026287947891568324953,
    0.026354986615032123009174574129767,
    0.040939156701306312642667714059195,
    0.054904695975835191925869223052573,
    0.068038333812356917207186411527832,
    0.080140700335001018013234947698449,
    0.091028261982963649811497220528951,
    0.100535949067050644202206890391193,
    0.108519624474263573168741067109265,
    0.114858259145711646246415516364738,
    0.119455763535784766908450571383244,
    0.122242442990310041058974526463941,
    0.123176053726715451203902873079338
  ).finished();

template <typename Scalar_>
const Array<Scalar_, 31, 1> QuadratureKronrod<Scalar_>::abscissaeGaussKronrod61 =
  (Array<Scalar_, 31, 1>() <<
    0.999484410050490637571325895705811,
    0.996893484074649540271630050918695,
    0.991630996870404594858628366109486,
    0.983668123279747209970032581605663,
    0.973116322501126268374693868423707,
    0.960021864968307512216871025581798,
    0.944374444748559979415831324037439,
    0.926200047429274325879324277080474,
    0.905573307699907798546522558925958,
    0.882560535792052681543116462530226,
    0.857205233546061098958658510658944,
    0.829565762382768397442898119732502,
    0.799727835821839083013668942322683,
    0.767777432104826194917977340974503,
    0.733790062453226804726171131369528,
    0.697850494793315796932292388026640,
    0.660061064126626961370053668149271,
    0.620526182989242861140477556431189,
    0.579345235826361691756024932172540,
    0.536624148142019899264169793311078,
    0.492480467861778574993693061207709,
    0.447033769538089176780609900322854,
    0.400401254830394392535476211542661,
    0.352704725530878113471037207089374,
    0.304073202273625077372677107199257,
    0.254636926167889846439805129817805,
    0.204525116682309891438957671002025,
    0.153869913608583546963794672743256,
    0.102806937966737030147096751318001,
    0.051471842555317695833025213166723,
    0.000000000000000000000000000000000
  ).finished();

template <typename Scalar_>
const Array<Scalar_, 31, 1> QuadratureKronrod<Scalar_>::weightsGaussKronrod61 =
  (Array<Scalar_, 31, 1>() <<
    0.001389013698677006833562139792867,
    0.003890461127099883839045569370529,
    0.006630703915931292517808986010451,
    0.009273279659517750335380721332841,
    0.011823015253496342357517850841790,
    0.014369729507045804049055352751397,
    0.016920889189053273508164200733320,
    0.019414141193942380164491470304738,
    0.021828035821609193433135670940338,
    0.024191162078080600105676708906933,
    0.026509954882333102990224941779152,
    0.028754048765041291348346619110974,
    0.030907257562387764081350611089154,
    0.032981447057483724314813542818599,
    0.034979338028060025957884036273588,
    0.036882364651821227304945553783659,
    0.038678945624727594963266901569642,
    0.040374538951535957010480677940768,
    0.041969810215164248331327993162069,
    0.043452539701355895655539576209750,
    0.044814800133162665524594127482898,
    0.046059238271006977511552859824310,
    0.047185546569299156397674061312447,
    0.048185861757087126335026940842320,
    0.049055434555029781432825121871643,
    0.049795683427074202739987028257264,
    0.050405921402782349463969091843047,
    0.050881795898749603573120068355669,
    0.051221547849258774836245949389293,
    0.051426128537459023253190863116769,
    0.051494729429451570238213914557491
  ).finished();

template <typename Scalar_>
const Array<Scalar_, 15, 1> QuadratureKronrod<Scalar_>::weightsGauss61 =
  (Array<Scalar_, 15, 1>() <<
    0.007968192496166605615456025746128,
    0.018466468311090946122568870476283,
    0.028784707883323369336076126144309,
    0.038799192569627049596712782873144,
    0.048402672830594052902936716836224,
    0.057493156217619066481721653329935,
    0.065974229882180495128128513996908,
    0.073755974737705206268243849987575,
    0.080755895229420215354694938459680,
    0.086899787201082802873472302180537,
    0.092122522237786120245355338656333,
    0.096368737174644259331614897810322,
    0.099593420586795266003408810878680,
    0.101762389748405504316414002334530,
    0.102852652893558840336797333235780
  ).finished();

}

#endif // EIGEN_QUADRATURE_KRONROD_H
